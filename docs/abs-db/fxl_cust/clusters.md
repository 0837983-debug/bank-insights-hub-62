## FXL_CUST — смысловые кластеры

Ниже — группировка объектов `FXL_CUST` в “сутевые” кластеры с пояснением, **какая информация там живет**.

Полный перечень объектов с группировкой по префиксам/подкластерам: `object-list.md`.

---

## 1) Ядро витрины (master data): `FX_*`

Это набор “канонических” сущностей для каналов (клиент/счет/договор/документы/доступ).

- **Клиент**: `FX_CLIENT`
  - атрибуты клиента для каналов: `NAME`, `INN`, `PHONE/EMAIL`, адресные поля, признаки VIP/резидентства, `ABS_CLIENT_ID`/`EXTERNAL_ID`
- **Счет**: `FX_ACCOUNT`
  - номер `NUM`, владелец `OWNER_REF` → `FX_CLIENT`, банк `BANK_REF` → `FX_BANKS`, признаки доступных операций
- **Договор/контур обслуживания**: `FX_CONTRACT`
  - привязка к клиенту (`CLIENT_REF`), банку/оператору, настройки “lite”, anti‑fraud, OTP и т.п.
- **Адреса/банки/продукты**: `FX_ADDRESS`, `FX_BANKS`, `FX_ACCOUNT_PRODUCT`, `FX_CLIENT_GROUP`, …
- **Документы/сообщения**: `FX_DOC` (+ дочерние `FX_DOC_PAY`, `FX_DOC_MSG`, `FX_DOC_LOG`, …)
- **Пользователи/роли**: `FX_USER`, `FX_ROLES`, (и связанные `FX_*_RIGHT`, `FX_DB_USERS`, …)

Когда использовать:

- если нужно “как видит фронт/ДБО”, обычно удобнее читать именно `FX_*`;
- если нужна полная бухгалтерская истина/учет — в `TBG` данных больше, а `FX_*` чаще как витрина/проекция.

---

## 2) Канальная обвязка / витринные наборы: `FFB_*`

Самый большой кластер (231 таблица + 107 views). По именам видно, что это смесь:

- **витринных таблиц/кэшей** для каналов,
- **технических таблиц интеграции**,
- **историй/снапшотов/переездов** (суффиксы с датами, `*_TMP`, `*_OLD`, `*_HIST`, …).

Подкластеры (по 2‑му токену в имени):

- **`FFB_OPER_*`**: операционные справочники и метрики доступности операций/сценарии/тех.параметры
- **`FFB_ACC_*` / `FFB_GL_*`**: счета/балансы/проводки/витрина “счет+карта+остаток”
- **`FFB_PCF_*`**: связка с контуром PCF (карты/договора/статусы/загрузки)
- **`FFB_DPS_*` / `FFB_DPF_*`**: депозиты/счета вкладов/ограничения/доступность
- **`FFB_DIB_*`**: портфели/ЦБ/переоценка/строки (по названиям “DIB” контур)
- **`FFB_CARD_*`**: выписки/стейтменты/загрузчики карт
- **`FFB_MESSAGE_*` / `FFB_MAIL_*`**: сообщения клиенту/почтовые отправки (в т.ч. буферы)
- **`FFB_INTEGRATION_*`**: интеграционные очереди/шины/статусы
- **`FFB_CASHBACK_*` / `FFB_BROKER_*` / `FFB_OPCION_*`**: доменные подсистемы (кэшбэк/брокер/опцион и т.п.)
- **`FFB_FSSP_*`, `FFB_FNS_*`, `FFB_2NDFL_*`, `FM_F251_*`**: отчетность/регуляторика/служебные выгрузки

Практический смысл:

- если вы ищете “готовые витрины” под фронт — чаще всего это **views** `FFB_*` (например, `FFB_CUSTOMERS`, `FFB_ACCOUNTS`, `FFB_ACC_INFO`);
- если вы видите таблицу `FFB_*_YYYYMMDD` или `*_TMP` — относитесь как к **технической/временной**, пока не доказано обратное.

---

## 3) Тарифы/комиссии/лимиты: `TARIFF_*` + витринные представления

В `FXL_CUST` есть отдельный контур тарифов:

- таблицы: `TARIFF_*` (условия, значения, типы операций, расчет комиссий, лимиты, аудит)
- views: `V_TARIFF_OPER_CALC`, `TARIFF_UL_COND_IND_VW`, `FFB_TARIFF_*_VW`

Что там обычно хранится:

- справочники тарифов и условий (`TARIFF_UL`, `TARIFF_CONDITIONS`, `TARIFF_COND_VALUES`)
- результаты расчета комиссий по операциям (`TARIFF_OPER_CALC*`, `TARIFF_REG_OPER*`)
- лимиты/пороговые расчеты (`TARIFF_LIMIT_CALC*`)

---

## 4) Gateway/шлюз/события и “внешние” контуры: `GATE$*`, `AQ$_*`

- **`GATE$*`** (таблицы без префикса в списке): события/кредиты/карты/статусы/обороты (по именам `GATE$EVENTS`, `GATE$LOANS`, `GATE$LOAN_PAYMENTS`, …)
- **`AQ$_*`**: системные таблицы очередей Oracle AQ (например, `AQ$_VB_TRANSPORT_QUEUE_L`) — транспорт/интеграция, не бизнес‑сущности сами по себе

---

## 5) Отчетность/регуляторика/скоринг (фрагменты)

По именам выделяются под‑контуры:

- **NBKI**: `CCB_NBKI_*` (обмен/запросы в бюро кредитных историй)
- **FSSP/FNS/2NDFL/F251**: `FFB_FSSP_*`, `FFB_FNS_*`, `FFB_2NDFL_*`, `FM_F251_*`, `F251_*` (служебные выгрузки/формы)
- **FRAUDWALL**: `FRAUDWALL_*` (обучение/справочники/балансы для антифрода)

---

## 6) Временные/исторические/архивные таблицы (технический кластер)

Признаки, что таблица “техническая”:

- суффиксы дат/версий: `*_2020...`, `*_2810`, `*_20241119`, `*_110620`, …
- `*_TMP`, `*_OLD`, `*_BAK_*`, `*_HIST*`, `*_ARC*`
- миграционные/резервные `MGC_*` с датами (копии сущностей ядра/срезы)

Их обычно не используют как целевую витрину, но они важны для:

- расследований/сверок,
- разовых миграций,
- бэкапов перед изменениями.

