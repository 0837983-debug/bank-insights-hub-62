/**
 * Maps row_code to human-readable names
 * This should be replaced with data from config.table_rows when available
 */

const rowNameMap: Record<string, string> = {
  // Financial Results - Income
  "i1": "Чистый процентный доход (ЧПД)",
  "i2": "Процентные доходы",
  "i2-1": "Доходы по кредитам ФЛ",
  "i2-2": "Доходы по кредитам ЮЛ",
  "i2-3": "Доходы от размещений",
  "i3": "Процентные расходы",
  "i3-1": "Расходы по депозитам ФЛ",
  "i3-2": "Расходы по депозитам ЮЛ",
  "i3-3": "Прочие процентные расходы",
  "i4": "Чистый комиссионный доход (ЧКД)",
  "i5": "Комиссии международных переводов",
  "i5-1": "Переводы в СНГ",
  "i5-2": "Переводы в Европу",
  "i5-3": "Переводы в Азию",
  "i6": "Комиссии обслуживания",
  "i6-1": "Обслуживание карт",
  "i6-2": "Обслуживание счетов",
  "i6-3": "Прочее обслуживание",
  "i7": "Прочие комиссии",
  "i8": "Доходы по FX",
  "i9": "Спред конвертаций",
  "i9-1": "USD/RUB",
  "i9-2": "EUR/RUB",
  "i9-3": "Прочие пары",
  "i10": "Маржа по FX-операциям",
  "i11": "Доход трейдинга",
  "i12": "Прочие доходы",
  "i13": "Операционные",
  "i14": "Прочие финансовые",

  // Financial Results - Expenses
  "e1": "ФОТ",
  "e2": "Заработная плата",
  "e2-1": "Основной персонал",
  "e2-2": "Менеджмент",
  "e2-3": "Бэк-офис",
  "e3": "Обязательные взносы",
  "e3-1": "ПФР",
  "e3-2": "ФСС",
  "e3-3": "ФОМС",
  "e4": "Прочие OPEX",
  "e5": "Аренда",
  "e5-1": "Офисы",
  "e5-2": "Дата-центры",
  "e5-3": "Прочая аренда",
  "e6": "Процессинг",
  "e6-1": "Карточный процессинг",
  "e6-2": "Переводы",
  "e6-3": "Прочий процессинг",
  "e7": "Эквайринг",
  "e8": "Услуги поставщиков",
  "e9": "Прочие OPEX",
  "e10": "Резервы",
  "e11": "Создание резервов",
  "e11-1": "Резервы по кредитам",
  "e11-2": "Резервы по гарантиям",
  "e11-3": "Прочие резервы",
  "e12": "Восстановление",
  "profit": "Финансовый результат",
  
  // Balance - Assets
  "a1": "Активы",
  "a2": "Наличные и эквиваленты",
  "a2-1": "Касса",
  "a2-2": "Счета в ЦБ",
  "a2-3": "Прочие эквиваленты",
  "a3": "Корреспондентские счета",
  "a3-1": "Банки-резиденты",
  "a3-2": "Банки-нерезиденты",
  "a4": "Инвестиции",
  "a4-1": "ОФЗ",
  "a4-2": "Корпоративные облигации",
  "a4-3": "Акции",
  "a5": "Рабочие активы",
  "a5-1": "Кредиты юр. лицам",
  "a5-2": "Кредиты физ. лицам",
  "a5-3": "МБК размещённые",
  "a5-4": "Прочие активы",
  
  // Balance - Liabilities
  "l1": "Пассивы",
  "l2": "Депозиты клиентов",
  "l2-1": "Срочные депозиты ФЛ",
  "l2-2": "Срочные депозиты ЮЛ",
  "l2-3": "Сберегательные счета",
  "l3": "Остатки ДВС",
  "l3-1": "Текущие счета ФЛ",
  "l3-2": "Текущие счета ЮЛ",
  "l3-3": "Эскроу и спецсчета",
  "l4": "Привлечённые средства",
  "l4-1": "МБК привлечённые",
  "l4-2": "Выпущенные облигации",
  "l4-3": "Субординированные займы",
};

/**
 * Maps row_code to descriptions
 */
const rowDescriptionMap: Record<string, string> = {
  // Balance - Assets
  "a2": "Денежные средства в кассе и на счетах в ЦБ",
  "a2-1": "Наличные в кассах отделений",
  "a2-2": "Обязательные резервы и остатки в ЦБ",
  "a2-3": "Краткосрочные высоколиквидные вложения",
  "a3": "Счета ностро в банках-корреспондентах",
  "a3-1": "Счета в российских банках",
  "a3-2": "Счета в иностранных банках",
  "a4": "Ценные бумаги и депозиты в других банках",
  "a4-1": "Облигации федерального займа",
  "a4-2": "Облигации крупных корпораций",
  "a4-3": "Долевые ценные бумаги",
  "a5": "Кредиты, дебиторская задолженность, операционные активы",
  "a5-1": "Корпоративное кредитование",
  "a5-2": "Розничное кредитование",
  "a5-3": "Межбанковские кредиты выданные",
  "a5-4": "ОС, НМА, дебиторская задолженность",
  
  // Financial Results - Income
  "i1": "Разница между процентными доходами и расходами",
  "i4": "Доходы от комиссий за услуги банка",
  "i8": "Доходы от валютно-обменных операций",
  "i9": "Доход от разницы курсов покупки и продажи валюты",
  
  // Financial Results - Expenses
  "e1": "Фонд оплаты труда: зарплаты и обязательные взносы",
  "e4": "Операционные и административные расходы",
  "e6": "Расходы на обработку транзакций",
  "e10": "Изменение резервов на возможные потери",
  
  // Balance - Liabilities
  "l2": "Срочные депозиты и сберегательные счета клиентов",
  "l3": "Остатки на текущих счетах и спецсчетах",
  "l4": "Привлечённые заёмные средства",
};

/**
 * Get human-readable name for row_code
 */
export function getRowName(rowCode: string): string {
  return rowNameMap[rowCode] || rowCode;
}

/**
 * Get description for row_code
 */
export function getRowDescription(rowCode: string): string | undefined {
  return rowDescriptionMap[rowCode];
}

/**
 * Determine if row_code represents a group (based on naming pattern)
 */
export function isRowGroup(rowCode: string): boolean {
  // Groups are typically single-level codes like "i1", "i2", "i4", "e1"
  // Children have dashes like "i2-1", "i2-2"
  return !rowCode.includes("-");
}

/**
 * Get parent_id from row_code (for hierarchical structure)
 */
export function getParentId(rowCode: string): string | undefined {
  // Extract parent from codes like "i2-1" -> "i2"
  const parts = rowCode.split("-");
  if (parts.length > 1) {
    return parts[0];
  }
  return undefined;
}

/**
 * Get sort order based on row_code pattern
 */
export function getSortOrder(rowCode: string): number {
  // Extract numeric prefix (i1 -> 1, i2 -> 2, i2-1 -> 201)
  const match = rowCode.match(/^[a-z](\d+)/);
  if (match) {
    const base = parseInt(match[1]) * 1000;
    // Add sub-level if exists (i2-1 -> 2001)
    const subMatch = rowCode.match(/-(\d+)$/);
    if (subMatch) {
      return base + parseInt(subMatch[1]);
    }
    return base;
  }
  return 0;
}
