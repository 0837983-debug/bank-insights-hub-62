# План: Удаление `/api/layout` — QA

**Цель:** убедиться, что `/api/layout` удалён и UI работает на `/api/data`.
**Статус:** ✅ Завершено
**Зависимости:** Frontend должен быть ✅

## Задачи
- [x] Прогнать все предыдущие автотесты, актуализировать при необходимости. ✅
- [x] Проверить, что `/api/layout` недоступен (например, 404). ✅
- [x] Проверить, что UI использует `/api/data?query_id=layout`. ✅
- [x] Обновить/удалить тесты, которые используют `/api/layout`. ✅
- [x] Если найдено расхождение — оформить отчет (что/где/шаги/ожидание/факт/логи). ✅ (расхождений не обнаружено)
- [x] Добавить фронтовые проверки (если были изменения UI). ✅

## Файлы для изменения
- `e2e/` (тесты layout)
- `backend/src/**/__tests__` (если есть API-тесты)

## Критерии завершения
- [x] Все актуальные тесты проходят ✅
- [x] `/api/layout` недоступен ✅ (404)
- [x] Отчеты оформлены при обнаружении ошибок ✅ (ошибок не обнаружено)

## Результаты выполнения

### Созданные файлы
- ✅ `e2e/remove-layout-endpoint.spec.ts` - новые тесты для проверки удаления `/api/layout`
- ✅ `AGENT_PLAN_REMOVE_LAYOUT_QA_REPORT.md` - отчет о выполнении

### Обновленные файлы
- ✅ `e2e/step8-header-top-level.spec.ts` - обновлен для использования нового endpoint
- ✅ `e2e/layout-data-source-key.spec.ts` - обновлен для использования нового endpoint
- ✅ `e2e/button-components.spec.ts` - обновлен для использования нового endpoint

### Результаты проверок
- ✅ `/api/layout` возвращает 404 (endpoint удален)
- ✅ `/api/data?query_id=layout` работает корректно
- ✅ Frontend использует новый endpoint через `fetchLayout`
- ✅ Тесты обновлены и актуальны

### Обнаруженные расхождения
- ✅ Расхождений не обнаружено. Все проверки пройдены успешно.

## Инструкции
1. Убедись, что Frontend завершен (✅).
2. Выполни задачи по порядку.
3. Обнови статус этого файла на ✅.
4. НЕ переходи к задачам других агентов.
